swagger: '2.0'
info:
  version: '1.0'
  title: Course Batch Management API(s)
  termsOfService: 'https://github.com/project-sunbird/sunbird-commons/blob/master/LICENSE'
  contact:
    email: admin@open-sunbird.org
  description: >-
        The Course Batch Management API resources perform operations related to course batch management on the Sunbird Platform. The basic operations include Creation, Updation,Joining ,Listing and Updating the course sttaus
  license:
    name: GNU Affero General Public License v3.0
    url: 'https://github.com/project-sunbird/sunbird-commons/blob/master/LICENSE'
host: staging.open-sunbird.org
basePath: /api/course/v1
securityDefinitions:
  auth:
    type: apiKey
    name: api_key
    in: header
schemes:
  - https
consumes:
  - application/json
  - multipart/form-data
  - application/x-www-form-urlencoded
produces:
  - application/json
paths:
  /batch/create:
    post:
      description: >-
        This API is associated with creating a batch on the Sunbird Platform.
          - The format of the resource URL is '{{host}}/v1/course/batch/create' 
          - The **_/batch/create_** endpoint executes "create batch" request to create a new batch.
          - It is a must to provide values for mandatory parameters that are marked with *. 
          
      summary: Creates a Batch
      tags:
      - Course Batch APIs
      operationId: '{{host}}/course/v1/batch/create'
      produces:
      - application/json
      parameters:
      - name: Body
        in: body
        required: true
        description: >-
            The body refers to the format of the request.
              - The body contains metadata about the new batch to be created.
        schema:
          allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiRequest'
             -  $ref: '#/definitions/SingleCreatebatchReq'
      - name: Content-Type
        in: header
        required: true
        type: string
        description: >-
            The Content Type entity is the media type of the resource.Possible media types can be:- 
              - Application/json
              - Multipart/form-data
              - Application/x-www-form-urlencoded
      - name: ts
        in: header
        required: true
        type: string
        description: 'The time stamp when the **create batch** request was sent. '
      - name: X-msgid
        in: header
        required: true
        type: string
        description: 'This unique ID that identifies a request, if the same API is executed multiple times.'
      - name: x-authenticated-user-token
        in: header
        required: true
        type: string
        description: 'The registered user ID to execute the API.'
      - name: Authorization
        in: header
        required: true
        type: string
        description: 'All content APIs require authorization for use. Specify the authorization key received from the administrator when placing the request for use of the API.'
      responses:
        '200':
          description: 'OK ! Successful operation."create batch " operation was successfully executed.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/CreateBatchResponse'
        '400':
          description: 'BAD REQUEST. "create batch" operation failed ! The possible reason for failure is that you may have missed providing input for a mandatory parameter.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
        '404':
          description: 'Resource not found' operation failed! The possible reason for failure is that the course ID is invalid.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'     
        '500':
          description: 'INTERNAL SERVER ERROR ! Looks like something went wrong! We track these errors automatically, but if the problem persists feel free to contact us. In the meantime, try refreshing.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
             
  /batch/read/{Batch_Id}:
    parameters:
      - in: path
        name: Batch_Id
        type: string
        required: true
        description: 'Append a valid Batch ID To the Request URL'   
    get:
      description: >-
        This API is used to fetch a particular batch on the Sunbird Platform.
          - {...}refers to a section of the read/{Batch_Id} endpoint URL path that needs to be replaced with the appropriate ID.
          - The **_/batch/read/{Batch_Id}_** endpoint executes "Fetch a batch" request to fetch a particular batch.
          - It is a must to provide values for mandatory parameters that are marked with *. 
          
      summary: Fetches a particular Batch
      tags:
      - Course Batch APIs
      operationId: getBatch
      produces:
      - application/json
      parameters:
      - name: Content-Type
        in: header
        required: true
        type: string
        description:  >-
            The Content Type entity is the media type of the resource.Possible media types can be:- 
              - Application/json
              - Multipart/form-data
              - Application/x-www-form-urlencoded
      - name: ts
        in: header
        required: true
        type: string
        description: 'The time stamp when the **Fetch a batch** request was sent. '
      - name: X-msgid
        in: header
        required: true
        type: string
        description: 'This unique ID that identifies a request, if the same API is executed multiple times.'
      - name:  x-authenticated-user-token
        in: header
        required: true
        type: string
        description: 'The registered User ID to execute the API.'
      - name: Authorization
        in: header
        required: true
        type: string
        description: 'All content APIs require authorization for use. Specify the authorization key received from the administrator when placing the request for use of the API.'
      responses:
        '200':
          description: 'OK ! Successful operation."Fetch a batch" operation was successfully executed.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/SingleBatchResponseWrapper'
            
        '400':
          description: 'BAD REQUEST,"Fetch a batch" operation failed ! The possible reason for failure is that you may have missed providing input for a mandatory parameter.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
        '404':
          description: 'Resource not found" operation failed ! The possible reason for failure is that Batch ID is invalid.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'     
        '500':
          description: 'INTERNAL SERVER ERROR ! Looks like something went wrong! We track these errors automatically, but if the problem persists feel free to contact us. In the meantime, try refreshing.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'

  /batch/user/add/{Batch_Id}:  
    parameters:
      - in: path
        name: Batch_Id
        type: string
        required: true
        description: 'Append a valid Batch ID To the Request URL'   
    post:
      description: >-
        This API is associated with addding a user  to a particular batch on the Sunbird Platform.
          - The format of the resource URL is '{{host}}/course/v1/batch/user/add/{Batch_Id}'
          - The **_/batch/user/add/{Batch_Id}_** endpoint executes "Add user to a batch" request to add a registered user to a specific batch.
          - It is a must to provide values for mandatory parameters that are marked with *. 
          
      summary: Add User to a specific batch
      tags:
      - Course Batch APIs
      operationId: '{{host}}/course/v1/batch/user/add/0123164681508700160'
      produces:
      - application/json
      parameters:
      - name: Body
        in: body
        required: true
        description: >-
            The body refers to the format of the request.
              - The body contains metadata about the user to be added to a batch.
        schema:
          allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/AddUserToBatchReq'
      - name: Content-Type
        in: header
        required: true
        type: string
        description: >-
            The Content Type entity is the media type of the resource.Possible media types can be:- 
              - Application/json
              - Multipart/form-data
              - Application/x-www-form-urlencoded
      - name: ts
        in: header
        required: true
        type: string
        description: 'The time stamp when the **Add user to batch** request was sent. '
      - name: X-msgid
        in: header
        required: true
        type: string
        description: 'This unique ID that identifies a request, if the same API is executed multiple times.'
      - name:  x-authenticated-user-token
        in: header
        required: true
        type: string
        description: 'The registered User ID to execute the API.'
      - name: Authorization
        in: header
        required: true
        type: string
        description: 'All content APIs require authorization for use. Specify the authorization key received from the administrator when placing the request for use of the API.'
      responses:
        '200':
          description: 'OK ! Successful operation."Add user to a batch" operation was successfully executed. in response it will contains userId and staus map'
          schema:
            allOf:
              - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
              - $ref: '#/definitions/AddUserToBatchResp'
        '400':
          description: 'BAD REQUEST,"create batch" operation failed ! The possible reason for failure is that you may have missed providing input for a mandatory parameter.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
        '500':
          description: 'INTERNAL SERVER ERROR ! Looks like something went wrong! We track these errors automatically, but if the problem persists feel free to contact us. In the meantime, try refreshing.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
  /batch/list:
    post:
      description: >-
        This API is used to search course batches on the basis of different stored batch attributes.
          - The format of the resource URL is '{{host}}/course/v1/batch/search'
          - The **_/batch/read_** endpoint executes "Lists the existing batches" request to fetch existing batches.
          - It is a must to provide values for mandatory parameters that are marked with *. 
          
      summary: Lists the existing batches
      tags:
      - Course Batch APIs 
      operationId: '{{host}}/course/v1/batch/search'
      produces:
      - application/json
      parameters:
      - name: Body
        in: body
        required: true
        description: >-
            The body refers to the format of the request.
              - The body contains metadata about the batch.
        schema:
         allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/CourseBatchSearchReq'
      
      - name: Content-Type
        in: header
        required: true
        type: string
        description: >-
            The Content Type entity is the media type of the resource.Possible media types can be:- 
              - Application/json
              - Multipart/form-data
              - Application/x-www-form-urlencoded
      - name: ts
        in: header
        required: true
        type: string
        description: 'The time stamp when the **Search batch** request was sent. '
      - name: X-msgid
        in: header
        required: true
        type: string
        description: 'This unique ID that identifies a request, if the same API is executed multiple times.'
      - name:  x-authenticated-user-token
        in: header
        required: true
        type: string
        description: 'The registered User ID to execute the API.'
      - name: Authorization
        in: header
        required: true
        type: string
        description: 'All content APIs require authorization for use. Specify the authorization key received from the administrator when placing the request for use of the API.'
      responses:
        '200':
          description: 'OK ! Successful operation."Lists the existing batches" operation was successfully executed.'
          schema:
            allOf:
              - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
              - $ref: '#/definitions/SearchBatchResponse'
        '400':
          description: 'BAD REQUEST,"create batch" operation failed ! The possible reason for failure is that you may have missed providing input for a mandatory parameter.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
        '500':
          description: 'INTERNAL SERVER ERROR ! Looks like something went wrong! We track these errors automatically, but if the problem persists feel free to contact us. In the meantime, try refreshing.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'

  /batch/update:
    patch:
      description: >-
        This API is used to update batch details on the Sunbird Platform.
          - The **_/batch/update_** endpoint executes "Update a batch" request to update an existing batch.
          - It is a must to provide values for mandatory parameters that are marked with *. 
          
      summary: Course Batch Update
      tags:
      - Course Batch APIs
      operationId: Course Batch Update
      produces:
      - application/json
      parameters:
      - name: Body
        in: body
        required: true
        description: >-
            The body refers to the format of the request.
              - The body contains metadata about the batch to be updated.
        schema:
          allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/CourseBatchUpdaterequest'
      - name: Accept
        in: header
        required: true
        type: string
        description: '**Accept** relates to content type such as **"MIME"**. It is used in the response body to execute multipurpose operations. Therefore, its important that the server is correctly set up, so that the MIME types transmitted are recognised and correct to determine what action to do when a resource is fetched.'
      - name: Content-Type
        in: header
        required: true
        type: string
        description: >-
            The Content Type entity is the media type of the resource.Possible media types can be:- 
              - Application/json
              - Multipart/form-data
              - Application/x-www-form-urlencoded
      - name: ts
        in: header
        required: true
        type: string
        description: 'Time Stamp at which **Fetch a batch** request was sent. '
      - name: X-msgid
        in: header
        required: true
        type: string
        description: 'This Id Uniquely identifies a request if the same API is executed multiple times.'
      - name:  x-authenticated-user-token
        in: header
        required: true
        type: string
        description: 'The Registered User ID to execute the API.'
      - name: Authorization
        in: header
        required: true
        type: string
        description: 'All content APIs require authorization for use. Specify the authorization key received from the administrator when placing the request for use of the API.'
      responses:
        '200':
          description: 'OK ! Successful operation."Update a batch" operation was successfully executed.'
          schema:
           allOf:
              - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
              - $ref: '#/definitions/CreateEmptyResponse'
        '400':
          description: 'BAD REQUEST,"create batch" operation failed ! The possible reason for failure is that you may have missed providing input for a mandatory parameter.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
        '500':
          description: 'INTERNAL SERVER ERROR ! Looks like something went wrong! We track these errors automatically, but if the problem persists feel free to contact us. In the meantime, try refreshing.'
          schema:
            allOf:
             - $ref: 'https://raw.githubusercontent.com/project-sunbird/project-sunbird.github.io/dev/apis/definitions/envelope.yaml#/ApiResponse'
             - $ref: '#/definitions/BatchCreateErrorResponse'
     
     
definitions:

  AddUserToBatchResp:
   description: ''
   type: object
   properties:
    result:
     type: object
   
  AddUserToBatchReq:
   description: 'request structure for add user to batch'
   type: object
   properties:
    request:
      type: object
      properties:
       userIds:
        type: array
        items:
          type: string
          description: 'contains user ids.'
   
  SearchBatchResponse:
   description: ''
   type: object
   properties:
    result:
     type: array
     items: 
      $ref: '#/definitions/GetBatchResponse'
    
  SingleCreatebatchReq:
    description: this will hold request data for single batch 
    type: object
    properties:
      request:
        $ref: '#/definitions/CreateBatchRequest'
    
   
  CreateBatchRequest:
    description: request body for creating a batch from a course.
    type: object
    properties:
      courseId:
        type: string
        description: 'content id for which user want to create a course'
      name:
        type: string
        description: 'name of the course'
      description:
        type: string
        description: 'about courses'
      enrollmentType:
        type: string
        description: 'possible values are {invite-only and open}'
      startDate: 
        type: string
        description: 'start data of the batch valid format is yyyy-MM-dd'
      endDate:
        type: string
        description: 'end data of batch valid format is yyyy-MM-dd'
      createdFor:
        type: array
        items:
          type: string
          description: 'this will hold list of organisations id.this is mandatory in case of invite-only badge'
      mentors:
        type: array
        items:
          type: string
          description: 'list of user id who will take care of course'
    required:
    - courseId
    - name
    - description
    - enrollmentType
    - startDate
          
    
     
  CreateEmptyResponse:
    description: 'contains response for created batch'
    type: object
    properties:
      result:
       type: object
       properties:
        response: 
          type: string
    
  CreateBatchResponse:
    description: 'contains response for created batch'
    type: object
    properties:
      result:
       type: object
       properties:
        response: 
          type: string
        batchId:
          type: string
          
  SingleBatchResponseWrapper:
   description: ''
   type: object
   properties:
    result:
     type: object
     properties:
      response:
       type: object
       $ref: '#/definitions/GetBatchResponse'
    
    
  GetBatchResponse:
    description: 'contains response for single batch object'
    type: object
    properties:
      identifier:
        type: string
      createdFor:
        type: array
        items:
          type: string
      courseAdditionalInfo:
        type: object
      endDate:
        type: string
        description: 'date format is yyyy-MM-dd'
      countIncrementDate:
        type: string
      description:
        type: string
      countDecrementDate:
        type: string
      updatedDate:
        type: string
      participant:
        type: object
      countIncrementStatus:
        type: boolean
      createdDate:
        type: string
        description : 'date format is 2017-08-07 12:41:16:151+0530'
      createdBy:
        type: string
        description : 'By whom the batch is created'
      courseCreator:
       type: string
      mentors:
       type: array
       items:
        type: string
      countDecrementStatus:
       type: boolean
      name:
       type: string
      id:
       type: string
      enrollmentType:
        type: string
      courseId:
       type: string
      startDate:
        type: string
        description : 'format is yyyy-MM-dd'
      status: 
        type: integer
        description : 'staus of the batch 0- not started, 1- started, 2- ended'
          
  CourseBatchSearchReq:
   description: 'this will contains request structure for batch search'
   type: object
   properties:
     request:
      type: object
      properties:
        query:
          type: string
          description: 'any text, it will do free text search'
        filters:
          type: object
          description: 'here you can pass the attribute and values'
          properties:
            objectType: 
             type: string
             description: 'which object you need to search'

  CourseBatchUpdaterequest:
    title: Course Batch UpdateRequest
    type: object
    properties:
      request:
        $ref: '#/definitions/Request7'
    required:
    - request
  Request7:
    title: Request7
    type: object
    properties:
      createdFor:
        description: 'org id can be added'
        type: array
        items:
          type: string
      endDate:
        description: 'batch end date can be updated if end date hasnt expired'
        type: string
      description:
        description: ''
        type: string
      name:
        description: ''
        type: string
      id:
        description: ''
        type: string
    required:
    - createdFor
    - endDate
    - description
    - name
    - id
    - enrollmentType
    
  BatchCreateErrorResponse:
    title: Create Content Error Response
    type: object
    allOf:
      - $ref: '#/definitions/EmptyResult'
  EmptyResult:
    title: Empty Result
    type: object
    properties:
      result:
        type: object
        description: Empty Result
